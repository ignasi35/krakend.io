<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.17" />


    <title>Concurrent Requests - Devops.faith KrakenD</title>
    <meta property="og:title" content="Concurrent Requests - Devops.faith KrakenD">
    








<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

<link rel="stylesheet" href="http://www.krakend.io/bootstrap/css/bootstrap.min.css">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">

<link rel="stylesheet" href="http://www.krakend.io/dist/css/AdminLTE.min.css">
<link rel="stylesheet" href="http://www.krakend.io/dist/css/skins/skin-black-light.min.css">
<link rel="stylesheet" href="http://www.krakend.io/dist/css/custom.css">






</head>
<body class="hold-transition sidebar-mini skin-black-light">
<div class="wrapper">

    
    <header class="main-header">

        
        <a href="http://www.krakend.io/" class="logo">
            
      <span class="logo-mini">
        <img src="http://www.krakend.io/images/logo-mini.png" alt="">
      </span>
            
            <img src="http://www.krakend.io/images/logo.png" alt="">
        </a>

        
        <nav class="navbar navbar-static-top" role="navigation">
            
            
            <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                <span class="sr-only">Toggle navigation</span>
            </a>
            

            <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="http://www.krakend.io//#features">Features</a>
                    </li>
                    <li>
                        <a href="http://www.krakend.io/download/">Download</a>
                    </li>
                    <li><a href="http://www.krakend.io/overview/introduction">Documentation</a></li>
                    
                </ul>
            </div>

            
            <div class="navbar-custom-menu">

                <ul class="nav navbar-nav">
                    <li>
                        <a href="http://www.krakend.io/designer/">Go to KrakenDesigner</a>
                    </li>
                    <li>
                        <a href="#" data-toggle="control-sidebar" title="Help"><i class="fa fa-question"></i> </a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>
<div >
    
    <aside class="main-sidebar">

        

        <section class="sidebar">
            


            
            
<ul class="sidebar-menu">
    <li class="header">Documentation</li>
    
    
        
        <li class="treeview">
            <a href="javascript:;">
                <i class='fa fa-road'></i>  <span>Getting Started</span>
                        <span class="pull-right-container">
                            <i class="fa fa-angle-left pull-right"></i>
                        </span>
            </a>
            <ul class="treeview-menu">
                
                <li class="">
                    <a href="/overview/introduction/"><i class="fa fa-circle-o %}"></i> Introduction</a>
                </li>
                
                <li class="">
                    <a href="/overview/installing/"><i class="fa fa-circle-o %}"></i> Installing KrakenD</a>
                </li>
                
                <li class="">
                    <a href="/overview/usage/"><i class="fa fa-circle-o %}"></i> Using KrakenD</a>
                </li>
                
                <li class="">
                    <a href="/overview/configuration/"><i class="fa fa-circle-o %}"></i> Configuration</a>
                </li>
                
            </ul>
        </li>
        
    
        
        <li class="treeview">
            <a href="/configuration/">
                <i class='fa fa-file-text-o'></i>  <span>Configuration Options</span>
            </a>
        <li>
        
    
        
        <li class="treeview active">
            <a href="javascript:;">
                <i class='fa fa-check'></i>  <span>Features</span>
                        <span class="pull-right-container">
                            <i class="fa fa-angle-left pull-right"></i>
                        </span>
            </a>
            <ul class="treeview-menu menu-open">
                
                <li class="">
                    <a href="/features/response-manipulation/"><i class="fa fa-circle-o %}"></i> Response manipulation</a>
                </li>
                
                <li class="active">
                    <a href="/features/concurrent-requests/"><i class="fa fa-circle-o %}"></i> Concurrent Requests</a>
                </li>
                
                <li class="">
                    <a href="/features/security/"><i class="fa fa-circle-o %}"></i> Security</a>
                </li>
                
                <li class="">
                    <a href="/features/other/"><i class="fa fa-circle-o %}"></i> Other</a>
                </li>
                
            </ul>
        </li>
        
    
        
        <li class="treeview">
            <a href="javascript:;">
                <i class='fa fa-heartbeat'></i>  <span>Throttling and Limits</span>
                        <span class="pull-right-container">
                            <i class="fa fa-angle-left pull-right"></i>
                        </span>
            </a>
            <ul class="treeview-menu">
                
                <li class="">
                    <a href="/throttling/overview/"><i class="fa fa-circle-o %}"></i> Throttling Overview</a>
                </li>
                
                <li class="">
                    <a href="/throttling/circuit-breaker/"><i class="fa fa-circle-o %}"></i> Circuit Breaker</a>
                </li>
                
                <li class="">
                    <a href="/throttling/rate-limit/"><i class="fa fa-circle-o %}"></i> Rate Limits</a>
                </li>
                
            </ul>
        </li>
        
    
        
        <li class="treeview">
            <a href="javascript:;">
                <i class='fa fa-space-shuttle'></i>  <span>Command line commands</span>
                        <span class="pull-right-container">
                            <i class="fa fa-angle-left pull-right"></i>
                        </span>
            </a>
            <ul class="treeview-menu">
                
                <li class="">
                    <a href="/commands/run/"><i class="fa fa-circle-o %}"></i> Run</a>
                </li>
                
                <li class="">
                    <a href="/commands/check/"><i class="fa fa-circle-o %}"></i> Check</a>
                </li>
                
            </ul>
        </li>
        
    
        
        <li class="treeview">
            <a href="/download/">
                <i class='fa fa-download'></i>  <span>Download KrakenD</span>
            </a>
        <li>
        
    
        
        <li class="treeview">
            <a href="javascript:;">
                <i class='fa fa-bar-chart'></i>  <span>Benchmarks</span>
                        <span class="pull-right-container">
                            <i class="fa fa-angle-left pull-right"></i>
                        </span>
            </a>
            <ul class="treeview-menu">
                
                <li class="">
                    <a href="/benchmarks/overview/"><i class="fa fa-circle-o %}"></i> Overview</a>
                </li>
                
                <li class="">
                    <a href="/benchmarks/api-gateway-benchmark/"><i class="fa fa-circle-o %}"></i> KrakenD vs others</a>
                </li>
                
                <li class="">
                    <a href="/benchmarks/aws/"><i class="fa fa-circle-o %}"></i> On Amazon Web Services</a>
                </li>
                
                <li class="">
                    <a href="/benchmarks/local/"><i class="fa fa-circle-o %}"></i> Local machine</a>
                </li>
                
            </ul>
        </li>
        
    
        
        <li class="treeview">
            <a href="/faq">
                <i class='fa fa-wrench'></i>  <span>Troubleshooting</span>
            </a>
        <li>
        
    
        
        <li class="treeview">
            <a href="http://github.com/devopsfaith/krakend/issues">
                <i class='fa fa-github'></i>  <span>Issues</span>
            </a>
        <li>
        
    
</ul>

            
        </section>
        
    </aside>

    
    <div class="content-wrapper">
        <section class="content-header">
            
<h1>
    Concurrent Requests
    <small> Documentation </small>
</h1>

        </section>

        <section class="content">
            
<div class="row">
    <section class="col-md-12 docs">

        <div class="box box-primary">
            <div class="box-body">
                
                

                <p>If your backend services are running on several instances, you could use a <code>concurrency_level</code> bigger than 1 with all your idempotent requests, in order to improve the error rate and response time distribution of the exposed endpoint. KrakenD will send up to <code>concurrency_level</code> concurrent requests to the backends, ignoring the possible failures until it gets a succesful response or all the requests fail. Krakend will use the fastest succesful response and cancell the pending ones.</p>

<p>The tradeoff of this strategy is an increment of the loads the backend services will recive, so make sure your infrastructure is ready for it. But your users will love it!</p>

<p>In order to demonstrate the impact of this component, let&rsquo;s imagine two different scenarios: the happy one and the sad one. Here you have the cumulative distribution and the probability distribution of these two cases (the time range is just a &lsquo;placeholder&rsquo; for whatever your actual response time values are, just replace the <code>100</code> with you <code>max_response_time</code>):</p>

<p><img src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQZEwr430hAJn7K8VeBi6ie4STDylM1BXztdT_3-S4K3nP4tEb7gFks7Rh_MGSy3Gvbjr-MBO3sviNn/pubchart?oid=1037931453&amp;format=image" alt="CDF happy vs sad" />
<img src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQZEwr430hAJn7K8VeBi6ie4STDylM1BXztdT_3-S4K3nP4tEb7gFks7Rh_MGSy3Gvbjr-MBO3sviNn/pubchart?oid=102602606&amp;format=image" alt="PDF happy vs sad" /></p>

<p>Just as a reminder: for the CDF graphs, the more to the left the line is, the better. For the PDF graphs, the more to the left and the narrow the peak is, the better.</p>

<p>This is the effect of using different concurrency levels for the happy case (notice how the response times are concentrated arround 20% of the <code>max_response_time</code>):</p>

<p><img src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQZEwr430hAJn7K8VeBi6ie4STDylM1BXztdT_3-S4K3nP4tEb7gFks7Rh_MGSy3Gvbjr-MBO3sviNn/pubchart?oid=1765475588&amp;format=image" alt="CDF concurrency happy" />
<img src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQZEwr430hAJn7K8VeBi6ie4STDylM1BXztdT_3-S4K3nP4tEb7gFks7Rh_MGSy3Gvbjr-MBO3sviNn/pubchart?oid=2114484604&amp;format=image" alt="PDF concurrency happy" /></p>

<p>Here, you have the effects for the sad case:</p>

<p><img src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQZEwr430hAJn7K8VeBi6ie4STDylM1BXztdT_3-S4K3nP4tEb7gFks7Rh_MGSy3Gvbjr-MBO3sviNn/pubchart?oid=157615107&amp;format=image" alt="CDF concurrency sad" />
<img src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQZEwr430hAJn7K8VeBi6ie4STDylM1BXztdT_3-S4K3nP4tEb7gFks7Rh_MGSy3Gvbjr-MBO3sviNn/pubchart?oid=554459729&amp;format=image" alt="PDF concurrency sad" /></p>

<p>The concurrent request component also reduces the error rate of the exposed endpoint by <strong>orders of magnitude</strong>.</p>

<p><img src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQZEwr430hAJn7K8VeBi6ie4STDylM1BXztdT_3-S4K3nP4tEb7gFks7Rh_MGSy3Gvbjr-MBO3sviNn/pubchart?oid=707642902&amp;format=image" alt="Error concurrency up to 2" />
<img src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQZEwr430hAJn7K8VeBi6ie4STDylM1BXztdT_3-S4K3nP4tEb7gFks7Rh_MGSy3Gvbjr-MBO3sviNn/pubchart?oid=1242783640&amp;format=image" alt="Error concurrency bigger than 2" /></p>

<p>Since the scale of the previous graphs is hidding the huge impact, let&rsquo;s use a logaritmic scale:</p>

<p><img src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQZEwr430hAJn7K8VeBi6ie4STDylM1BXztdT_3-S4K3nP4tEb7gFks7Rh_MGSy3Gvbjr-MBO3sviNn/pubchart?oid=359184017&amp;format=image" alt="error concurrent calls" /></p>


            </div>
    </section>
</div>

        </section>
    </div>
</div>

</div>


<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-5">
                <img src="/images/logo-inverse.png" >
                <p class="lead">The <strong>ultra performer</strong> API Gateway.</p>
                <span>KrakenD helps applications developers to rapidly release features by eliminating all the complexities of SOA architectures, while offering a unique performance.</span>
                <div class="social">
                    <a href="https://www.facebook.com/apigateway" target="_blank"  title="Facebook">
                        <i class="fa fa-facebook-official" aria-hidden="true"></i><span class="sr-only">Facebook</span>
                    </a>
                    <a href="https://twitter.com/devopsfaith" target="_blank" class="social-btn-twitter" title="Twitter">
                        <i class="fa fa-twitter" aria-hidden="true"></i><span class="sr-only">Twitter</span>
                    </a>
                    <a href="https://github.com/devopsfaith" target="_blank" class="social-btn-github" title="GitHub">
                        <i class="fa fa-github" aria-hidden="true"></i><span class="sr-only">GitHub</span>
                    </a>
                </div>

            </div>
            <nav>
                <div class="col-md-2 col-md-offset-1">
                    
                </div>
                <div class="col-md-2">
                    <h6>Product</h6>
                    <ul class="list-unstyled">
                        <li><a href="/#features/">Features</a></li>
                        
                        <li><a href="/benchmarks/overview/">Benchmarks</a></li>
                        <li><a href="/download/">Download</a></li>
                    </ul>

                </div>
                <div class="col-md-2">
                    <h6>Support</h6>
                    <ul class="list-unstyled">
                        <li><a href="/overview/introduction">Documentation</a></li>
                        <li><a href="https://github.com/devopsfaith/krakend" target="_blank">Open Source</a></li>
                        
                        <li><a href="mailto:hello@krakend.io">Contact Us</a></li>
                    </ul>
                </div>
            </nav>
        </div>
        <div class="row">
            <div class="col-md-5 additional-links">
                <strong>Copyright &copy; 2016 <a href="http://devops.faith">Devops Faith</a>.</strong> All rights reserved.
            </div>
            <div class="pull-right hidden-xs">
                Made with <i class="fa fa-heart-o" style="color:hotpink"></i> in Barcelona
            </div>
        </div>
    </div>
</footer>

    
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-87994359-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>


    
<aside class="control-sidebar control-sidebar-light">


    <div class="tab-content">
        
            <h3 class="control-sidebar-heading">Need help?</h3>
            <p>Contact a human. Or they say so...</p>
            <ul class="control-sidebar-menu">
                <li>
                    <a href="mailto:hello@krakend.io">
                        <i class="menu-icon fa fa-envelope bg-red"></i>

                        <div class="menu-info">
                            <h4 class="control-sidebar-subheading">Send us an email</h4>
                            <p>hello@krakend.io</p>
                        </div>
                    </a>
                </li>
                <li>
                    <a href="http://twitter.com/devopsfaith">
                        <i class="menu-icon fa fa-twitter bg-blue"></i>

                        <div class="menu-info">
                            <h4 class="control-sidebar-subheading">Tweet!</h4>
                            <p>@devopsfaith</p>
                        </div>
                    </a>
                </li>
            </ul>
            <h3 class="control-sidebar-heading">Access documentation</h3>
            <p><a href="">Krakend.io documentation</a></p>

    </div>
</aside>


<div class="control-sidebar-bg"></div>

</body>
</html>
<script src="http://www.krakend.io/plugins/jQuery/jquery-2.2.3.min.js"></script>
<script src="http://www.krakend.io/bootstrap/js/bootstrap.min.js"></script>
<script src="http://www.krakend.io/dist/js/app.min.js"></script>
